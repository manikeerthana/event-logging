language: java
dist: trusty
group: edge
jdk: openjdk8
#sudo: false

env:
  global:
      #travis encrypt -r gchq/event-logging GH_USER_AND_TOKEN="*****"
      #where ***** is '<github username>:<github personal access token>'
      #Required for curling the gh api to get the source of the latest event-logging release
      #travis encrypt -r gchq/event-logging GH_USER_AND_TOKEN="<github personal access token>"
    #- secure: "TOKbp0kSCBHm6xZHpmj28ZUPC4LpbZItn15Dcyk8sQ9EcYkFdwGEpD/qqkdA+9+GRCFIBmfvfHE1D5qKWICze5IYDgAgAabaDG3zygQ/W7WAyvVSO+4go6ZTZAhm/I/vJ6cwub47aYeV+OO4g+lZcTkWJpwBdJxRsXXFCXU5VRSoBc2hn2wUZuMpdyOpLb6Gs9QpJSnpRbOcXNIupJEc9t1LoO8dvXyJEL4sYLD1YiFammdDW+q/deaevTUJrsvXs1E8lSjyf/qZsUrJqYyzrnV2c2dPb/i/z2QYajPuJv5BlCjVFIROPV+JLepDDAMZGsjaXSNl8AxhYF2lXnQoTMCK8fkaINh2opGwhp7ksOXbpUM5B/x6bORl2wou75dsboMmzycQ08NlwzBrVZ7Lv33a3j02G5cwXKxkoP07VLixqaheOsEEJUINjQNrOuopqQA9v3jBecOBXIPs/SfJCTbu1/s9lFV9Vj5Lghn1VoHoG3n9dS9xPy9BDAf1dJCNNpfL+hDtVA9kx7haZ5Az2ueBMnrRF8TZJizyKvlK+EbXYayTGyxgNlHb6cUuQY0FcFzNnGPcxCvOaw0DW2gicFt1Flz7DYtjdj0037ExSIIm7EA1i9ucP5p/U5JASM66glE5IvnCREMzVZXxflhhEUUqbQ3lexvcZMoIgAl4ink="
#    - secure: "Dj0AtkItxitrOijaZc/STz/3oUyGBNaB6k3yhgZI3Fw2MDHqqV073nr5xWPawrP2AyQmRE8zRgrvLH7ZpjBcQiJnC2qYBho8Ap5ZpwtQJ6XMpPvKhlG9mXl8CQ31n0gukxJj3jSJn/+R3MPNYPxCUcQ87wOMnveY+0bJhWpfbsJKN/2OMpIc2yie2MUcJ9OpzeSfx/LekxZsTsNai6gMwB6l4l44gB2sBRPL5I3a6UFQHNS1+Z5qrlYraS2KvL2X20nfGG2SpbVfaJneNqISjPUKIsNfR1LYre/nJDSWxCpYjZfuqt6OoH9yUg/jmmKt6Y3+mF4x8/GavOs76ImBeaqBWX/esuyAQEOCfW2pcv2r6EdpGA9BQMCOi1SoEAiJC2kND4Sy+HtEkZ0xVBrAvFT/2v1F5BPu9POzsfw55R5RbwDrBO+N4zMaPtxlo7eUEJ+vPKxOgVJrU9qEIR/GEnwv3z5FXT1YxkmksWjxuXLxZlCO0NHYfB4uwdogmhD9B8dk+ZeF1fee7U088ytsvAk89cQde0CZm9n4by98gwmcopUzyQSuYaxhQHoI9sV9hCaFNwlMXwd39vO8Zbi6Wvf2upAzkgDBwG0SWMDFXppcfT7zxcYQMlouDsFpDLXqnEYTdqEJtSgSLoMCq+LXITzc+FaKu8I127USQIcikwY="


install: echo "skip 'gradle assemble' step to speed up build"

script: ./travis.script.sh

# Push to GitHub releases - the key was generated by the Travis CLI.
deploy:
  - provider: pages
    skip_cleanup: true
    github_token: $GITHUB_TOKEN
    local_dir: event-logging-api/build/docs/javadoc/
    target_branch: gh-pages
    on:
      branch: master
      tags: true
  - provider: releases
    api_key:
      # travis encrypt -r gchq/event-logging <github personal access token>
      secure: "52OQP+PUgNzYCFyPCS2QmjCqjYfPVU0vHl+bq+p8cemfQeiwZN4k5eXKAyIexNBT7zkpSa/oDGNVIFYDkhZr0XAWEihOXHZklSR6G0v3wdYBx745QWsUrWhl/CL7wgfqj1GfgkpOQCblLbiA/CNA9N4bu1o+fCceyys2PqQHHG3gaszl/oaHLkjZmBLiRe+WSgDZIYCFBMu9AmiLws2NI7w4ocWU/dCKDscsBlH8qouiXdFCZNHb0Jc1C1/od5Vco/oowqx/POuYnwrsIi8AQeRVi88q7eZXZDAGzR62oHgjSG5LHJtM+bgrgk+S3jrpPRd6P4FxAc2VVrNZ+t+LQtyHJQf8UB2aTuXQ12pxoeA0X91jtJAZR3Ds3j+aF+raXsNVwgOqVOPtPWgOIuqf8tQ3pF8r3elMZOb1manZFq5q6YXBpw44mhTJW9UppKj4/FFGOKO6hwRe210JxKuvgpnyTjY9V7+tg9vTh1m3pIvcXG+/9l1lPNoUKmsHywf4QRxhXBhOBJI5jqrojA+fEa50t92tV5pezRydrAzzKIujo56+QfkytssL1l9FTd4L0bTawr0W2WpcAX+TL7KmN159RPzcd+edImL3xBAKVWtItcXhaeXlfde5au6rneWbYrYjMONSCYabVq12ev8nhdOaPOWhySNX6kgcre0igxY="
    file_glob: true
    file: event-logging-api/build/libs/*.jar
    skip_cleanup: true
    on:
      tags: true

#clean out gradle caches as per travis docs
before_cache:
  - rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
  - rm -fr $HOME/.gradle/caches/*/plugin-resolution/

# Cache dependencies to speed up the build
cache:
  directories:
    - .autoconf
    - $HOME/.m2
    - $HOME/.gradle/caches/
    - $HOME/.gradle/wrapper/
